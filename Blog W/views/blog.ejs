<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('./partials/head') %>
  <title>Blog</title>
</head>

<body>
  <%- include('./partials/nav') %>

  <div class="container mt-4">
    <h1><%= blog.title %></h1>
    <img src="/<%= blog.coverImage %>" alt="Cover Image" class="img-fluid mb-3" />
    <pre class="mt-3"><%= blog.body %></pre>
  </div>

  <div class="container mt-4">
    <div class="d-flex align-items-center">
      <img src="<%= blog.createdBy.profileImageURL %>" width="50px" class="img-thumbnail me-2" alt="Profile Image">
      <span><%= blog.createdBy.fullName %></span>
    </div>
  </div>

  <div class="container mt-4">
    <h2>Comments (<%= comments.length %>)</h2>
    
    <% if (locals.user) { %>
      <form action="/blog/comment/<%= blog._id %>" method="post">
        <div class="mb-3">
          <input name="content" type="text" class="form-control" placeholder="Enter Your Comment">
          <button type="submit" class="btn btn-primary mt-2">Add Comment</button>
        </div>
      </form>
    <% } %> <!-- End of user check -->
    
    <div class="mt-4">
      <% comments.forEach(comment => { %>
        <div class="d-flex mb-3">
          <img src="<%= comment.createdBy.profileImageURL %>" width="50px" class="img-thumbnail me-2" alt="Commenter's Profile Image">
          <div>
            <strong><%= comment.createdBy.fullName %></strong>
            <p><%= comment.content %></p>
          </div>
        </div>
      <% }); %>
    </div>
  </div>

  <%- include('./partials/script') %>
</body>

</html>
